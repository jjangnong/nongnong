<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>김진영&장은영 결혼식 예매사이트</title>
<link href="https://fonts.googleapis.com/css2?family=Dongle:wght@700&display=swap" rel="stylesheet">
<style>
body {margin:0; font-family:'Noto Sans KR',sans-serif; background:url('https://raw.githubusercontent.com/jjangnong/nongnong/refs/heads/main/0UNIQ7164.jpg') no-repeat center center fixed; background-size:cover; color:white;}
header {background:rgba(0,0,0,0.2); padding:20px; text-align:center; font-size:1.5em; border-radius:8px; max-width:600px; margin:20px auto 0 auto; font-family:'Dongle',sans-serif; font-weight:700;}
form {background:rgba(0,0,0,0.2); width:90%; max-width:600px; margin:40px auto; padding:20px; border-radius:8px; box-sizing:border-box;}
label {display:block; margin-top:15px; font-weight:600;}
input, textarea {width:100%; padding:8px; margin-top:5px; border:none; border-radius:4px; box-sizing:border-box;}
button {margin-top:20px; width:100%; padding:12px; background-color:#637FDE; border:none; color:white; font-size:1em; border-radius:4px; cursor:pointer;}
button:hover {background-color:#637FDE;}
input[type="date"] {background-color:white; color:black;}
</style>
</head>
<body>

<header>
2025.12.28. 김진영&장은영 결혼식 예매사이트<br>
티켓 수령 날짜를 지정해주시면 확인 후 확정문자 드리겠습니다:D
</header>

<form id="reservation-form">
<label for="name">이름(단체명)</label>
<input type="text" id="name" name="name" required>
<label for="people">예매 인원</label>
<input type="number" id="people" name="people" min="1" max="10" value="1" required>
<label for="date">티켓 수령 날짜 (2025-10-01 ~ 2025-12-21)</label>
<input type="date" id="date" name="date" min="2025-10-01" max="2025-12-21" required>
<label for="message">요청사항</label>
<textarea id="message" name="message" rows="4" placeholder="짱농진농에게 한마디♥" required></textarea>
<button type="submit">예매하기</button>
</form>

<script>
const WEBAPP_URL = 'YOUR_WEBAPP_URL'; // 여기 Apps Script WebApp 배포 URL

const bookedDates = [];
const form = document.getElementById('reservation-form');
const dateInput = document.getElementById('date');

// 예약된 날짜 가져오기
async function fetchBookedDates() {
  try {
    const res = await fetch(WEBAPP_URL);
    const text = await res.text();
    const data = JSON.parse(text);
    bookedDates.push(...data);
  } catch(err){ console.error(err); }
}

fetchBookedDates();

// 날짜 선택 시 알림
dateInput.addEventListener('input', () => {
  if(bookedDates.includes(dateInput.value)) alert('이미 선택된 날짜입니다.');
});

// 폼 제출
form.addEventListener('submit', async e => {
  e.preventDefault();
  const name = form.name.value.trim();
  const people = form.people.value;
  const date = form.date.value;
  const message = form.message.value.trim();

  try {
    const res = await fetch(WEBAPP_URL, {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({name, people, date, message})
    });
    const text = await res.text();
    const result = JSON.parse(text);

    if(result.status==='success'){
      alert('예매 완료!\n이름:'+name+'\n날짜:'+date+'\n메시지:'+message);
      form.reset();
      bookedDates.push(date);
    } else {
      alert('예매 오류: '+result.message);
    }
  } catch(err){
    console.error(err);
    alert('전화로 문의 바랍니다.');
  }
});
</script>

</body>
</html>
